{"version":3,"file":"server-reach-by-image.min.js","sources":["../src/index.js"],"sourcesContent":["const defaults = {\n  timeout: 2500\n};\nconst errors = {\n  load_timeout: 'Loading image timed out',\n  load_fail: 'Loading image failed',\n  param_missing_urls: 'Url param(s) not specified',\n  param_timeout_integer: 'Timeout param should be an integer'\n};\n\nclass ServerReachByImage {\n  constructor(options = {}) {\n    this.options = Object.assign({}, defaults, options);\n    this.validateParams();\n  }\n\n  load() {\n    return new Promise((resolve, reject) => {\n      /* eslint-disable prefer-promise-reject-errors */\n      const fail = msg => reject({ msg: new Error(msg), status: false });\n\n      /* eslint-disable no-undef */\n      const img = new Image();\n      img.onload = () => resolve({ msg: null, status: true });\n      img.onerror = e => fail(errors.load_fail);\n      img.src = `${this.options.url}${this.options.imgUrl}?${new Date().getTime()}`;\n\n      setTimeout(() => fail(errors.load_timeout), this.options.timeout);\n    });\n  }\n\n  validateParams() {\n    if (!this.options.url || !this.options.imgUrl) {\n      throw new Error(errors.param_missing_urls);\n    }\n\n    this.options.url = this.options.url.replace(/\\/+$/, '');\n    if (!this.options.imgUrl.startsWith('/')) {\n      this.options.imgUrl = `/${this.options.imgUrl}`;\n    }\n\n    if (!Number.isInteger(this.options.timeout)) {\n      throw new Error(errors.param_timeout_integer);\n    }\n  }\n}\n\nmodule.exports = ServerReachByImage;\n"],"names":["defaults","errors","ServerReachByImage","options","Object","assign","validateParams","Promise","resolve","reject","fail","Error","msg","img","Image","onload","onerror","src","_this","url","imgUrl","Date","getTime","timeout","this","replace","startsWith","Number","isInteger","module","exports"],"mappings":"6TAAA,IAAMA,WACK,MAELC,EACU,0BADVA,EAEO,uBAFPA,EAGgB,6BAHhBA,EAImB,qCAGnBC,8BACQC,uKACLA,QAAUC,OAAOC,UAAWL,EAAUG,QACtCG,yFAIE,IAAIC,QAAQ,SAACC,EAASC,OAErBC,EAAO,mBAAOD,OAAc,IAAIE,MAAMC,WAAc,KAGpDC,EAAM,IAAIC,QACZC,OAAS,kBAAMP,OAAe,aAAc,OAC5CQ,QAAU,mBAAKN,EAAKT,MACpBgB,cAASC,EAAKf,QAAQgB,YAAMD,EAAKf,QAAQiB,oBAAU,IAAIC,MAAOC,sBAEvD,kBAAMZ,EAAKT,IAAsBiB,EAAKf,QAAQoB,wDAKtDC,KAAKrB,QAAQgB,MAAQK,KAAKrB,QAAQiB,aAC/B,IAAIT,MAAMV,WAGbE,QAAQgB,IAAMK,KAAKrB,QAAQgB,IAAIM,QAAQ,OAAQ,IAC/CD,KAAKrB,QAAQiB,OAAOM,WAAW,YAC7BvB,QAAQiB,kBAAaI,KAAKrB,QAAQiB,UAGpCO,OAAOC,UAAUJ,KAAKrB,QAAQoB,eAC3B,IAAIZ,MAAMV,wCAKtB4B,OAAOC,QAAU5B"}